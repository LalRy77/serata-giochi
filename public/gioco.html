<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Host – Serata Giochi</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body {
      margin:0; padding:0;
      background: url('/immagini/sfondo.jpg') center/cover no-repeat;
      font-family:Arial,sans-serif; color:white; text-align:center;
    }
    #wrap {
      padding:2em;
    }
    #titolo {
      font-size:3em; margin-bottom:.5em;
    }
    #img {
      max-width:80vw; max-height:50vh; margin-bottom:1em;
    }
    #domanda {
      font-size:2em; margin-bottom:1em;
    }
    .btn { padding:.8em 1.5em; font-size:1.2em; margin:.5em; border:none; border-radius:5px; cursor:pointer; }
    #mostra { background:#e74c3c; }
    #next   { background:#3498db; }
    #podio  { background:#f1c40f; }
  </style>
</head>
<body>
  <div id="wrap">
    <div id="titolo">In attesa di avviare…</div>
    <img id="img" src="" style="display:none;">
    <div id="domanda"></div>
    <button id="mostra" class="btn" disabled>Mostra risposta</button>
    <button id="next" class="btn" disabled>Domanda successiva</button>
    <button id="podio" class="btn" disabled>Classifica</button>
  </div>

  <script>
    const socket = io();
    const ps = new URLSearchParams(location.search);
    const room = ps.get('room');

    // join + parte subito
    socket.emit('join-host', room);
    socket.emit('start-game', room);

    let ultima;
    socket.on('new-question', q=>{
      ultima=q;
      document.getElementById('titolo').innerText = `Domanda ${q.numero}`;
      if(q.immagine){
        const im = document.getElementById('img');
        im.src=q.immagine; im.style.display='block';
      }
      document.getElementById('domanda').innerText = q.testo;
      document.getElementById('mostra').disabled=false;
      document.getElementById('next').disabled=true;
      document.getElementById('podio').disabled=true;
    });

    document.getElementById('mostra').onclick = ()=>{
      alert(`Risposta: ${ultima.corretta}`);
      document.getElementById('mostra').disabled=true;
      document.getElementById('next').disabled=false;
      document.getElementById('podio').disabled=false;
    };
    document.getElementById('next').onclick = ()=>{
      socket.emit('start-game', room);
    };
    document.getElementById('podio').onclick = ()=>{
      socket.emit('show-podium', room);
    };

    // … puoi aggiungere socket.on('podium',…) per la classifica …
  </script>
</body>
</html>
