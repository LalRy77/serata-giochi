<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>HOST - Serata Giochi</title>
</head>
<body>
  <h1>ðŸŽ¤ Host - Serata Giochi</h1>
  <div id="room-info"></div>
  <div id="question"></div>
  <div id="image"></div>
  <div id="answers"></div>
  <button onclick="showRanking()">Mostra Classifica</button>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const room = urlParams.get('room');
    const socket = io('https://serata-giochi.onrender.com');
    socket.emit('join-host', room);

    socket.on('new-question', q => {
      document.getElementById('question').innerText = q.domanda;
      document.getElementById('image').innerHTML = q.immagine ? '<img src="' + q.immagine + '" width="300">' : '';
      document.getElementById('answers').innerHTML = q.risposte.map(r => '<div>' + r + '</div>').join('');
    });

    function showRanking() {
      socket.emit('show-ranking', room);
    }
  </script>

  <div id="qrcode" style="margin: 30px;"></div>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    const qr = document.getElementById('qrcode');
    const url = window.location.origin + '/player.html?room=' + room;
    QRCode.toCanvas(document.createElement("canvas"), url, function (error, canvas) {
      if (!error) qr.appendChild(canvas);
    });
  </script>
</body>
</html>