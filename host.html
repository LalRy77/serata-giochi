
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>üñ•Ô∏è Host</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>üñ•Ô∏è Maxischermo</h1>
  <div id="codice-stanza"></div>
  <div id="qrcode" style="margin: 20px;"></div>
  <div id="domanda"></div>
  <div id="risposte"></div>
  <button onclick="mostraClassifica()">Mostra Classifica</button>

  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const room = params.get('room');
    document.getElementById('codice-stanza').textContent = "Codice stanza: " + room;

    const socket = io("https://serata-giochi.onrender.com");
    socket.emit('join-host', room);

    const url = "https://serata-giochi.onrender.com/player.html?room=" + room;
    QRCode.toCanvas(document.createElement("canvas"), url, function (error, canvas) {
      if (!error) document.getElementById('qrcode').appendChild(canvas);
    });

    socket.on('new-question', (q) => {
      const domDiv = document.getElementById('domanda');
      domDiv.innerHTML = "<h2>" + q.domanda + "</h2>";
      if (q.immagine) {
        domDiv.innerHTML += '<img src="' + q.immagine + '" style="max-width:400px;"><br>';
      }

      const rispDiv = document.getElementById('risposte');
      rispDiv.innerHTML = '';
      q.risposte.forEach((r, i) => {
        rispDiv.innerHTML += '<p>' + r + '</p>';
      });
    });

    function mostraClassifica() {
      socket.emit('show-ranking', room);
    }
  </script>
</body>
</html>
