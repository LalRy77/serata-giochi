<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Host</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="main" class="host-screen">
    <h1>ðŸŽ® Seleziona un gioco</h1>
    <div id="buttons"></div>
    <div id="qr"></div>
    <div id="codice-stanza"></div>
  </div>
  <script>
    fetch('giochi.json')
      .then(r => r.json())
      .then(giochi => {
        const container = document.getElementById('buttons');
        giochi.forEach(gioco => {
          const btn = document.createElement('button');
          btn.innerText = gioco.nome;
          btn.onclick = () => {
            fetch('/crea-stanza?quiz=' + gioco.file)
              .then(r => r.json())
              .then(d => {
                const room = d.room;
                const qr = document.createElement('img');
                qr.src = 'https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=https://www.borgodegliesploratori.com/SerataGiochi/player.html?room=' + room;
                const div = document.getElementById('qr');
                div.innerHTML = '';
                div.appendChild(qr);
                document.getElementById('codice-stanza').innerHTML = room;
              });
          };
          container.appendChild(btn);
        });
      });

    fetch('config.json')
      .then(r => r.json())
      .then(cfg => {
        if (cfg.sfondo) {
          document.body.style.backgroundImage = `url('${cfg.sfondo}')`;
          document.body.style.backgroundSize = 'cover';
          document.body.style.backgroundPosition = 'center';
        }
      });
  </script>
</body>
</html>